<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>

$(document).ready(function(){
  $("#run-button").click(() => {
	const solutionLog = $("#solution-log");
	
	solutionLog.text('');
    runSolution(solutionLog);
  });
});

const initializeSolutionsCounterObject = () => {
	return {
		1:0,
		2:0,
		3:0,
		4:0,
		5:0
	};
}
	
const getChestPearlCount=(hundredThousandSymbol, tenThousandSymbol, thousandSymbol, hundredSymbol, tenSymbol, oneSymbol)=>
		100000 * hundredThousandSymbol +
		10000 * tenThousandSymbol +
		1000 * thousandSymbol +
		100 * hundredSymbol +
		10 * tenSymbol +
		oneSymbol;

const getChest1PearlCount=({trident, n})=>
	getChestPearlCount(trident, n, trident, n, trident, n);

const getChest2PearlCount=({trident, bowAndArrow, epsilon})=>
	getChestPearlCount(trident, bowAndArrow, epsilon, epsilon, bowAndArrow, trident);

const getChest3PearlCount=({stickMan, Z, bowAndArrow})=>
	getChestPearlCount(stickMan, stickMan, Z, Z, bowAndArrow, bowAndArrow);

const getChest4PearlCount=({bowAndArrow, stitches, stickMan}) =>
	getChestPearlCount(bowAndArrow, stitches, stickMan, bowAndArrow, stitches, stickMan);

const getChest5PearlCount=({house, trident, bowAndArrow})=>
	getChestPearlCount(house, trident, bowAndArrow, trident, bowAndArrow, house);

const getSolutionText = (chestNumber, solutionCount, possibleSolutionsCount) =>
	`Chest ${chestNumber} contains ${solutionCount} solutions among ${possibleSolutionsCount} possible number combinations`;
	
const isValidSolution = (pearlCount) =>
		((pearlCount/7) / 11) % 13 === 0;
		
const checkSolution = (chestNumber, chestPearlCount, symbols, possibleSolutionsArray, foundSolutionsArray, html) => {

	possibleSolutionsArray[chestNumber]++;
	
	if (isValidSolution(chestPearlCount)) {
		foundSolutionsArray[chestNumber]++;
				
		html.append(`${getSolutionMessage(chestNumber, chestPearlCount, symbols)}<br>`);
	}
}

const getSolutionMessage = (chestNumber, chestPearlCount, symbols) =>{

	const keys = Object.keys(symbols)
	
	let msg = `Chest ${chestNumber} has a solution of ${chestPearlCount}. `
	
	for (key of keys){
		msg += `${key}=${symbols[key]}, `;
	}
	
	return msg;
}

const runSolution = (html) => {

	const t0 = performance.now()

	/*
	let trident = 1;
	let n = 0;
	let bowAndArrow = 1;
	let epsilon = 0;
	let stickMan = 1;
	let Z = 0;
	let stitches = 0;
	let house = 1;
	*/

	const foundSolutionsCount = initializeSolutionsCounterObject();

	const possibleSolutionsCount = initializeSolutionsCounterObject();

	//Chest 1 (trident, n, trident, n, trident, n)
	for (let trident = 1; trident<=9 ; trident++){
		for (let n = 0;n<=9;n++){
			if (trident == n){
				continue;
			}

			const symbols = {trident, n};
			checkSolution(1, getChest1PearlCount(symbols), symbols, possibleSolutionsCount, foundSolutionsCount, html);
		}
	}

	//Chest 2 (trident, bowAndArrow, epsilon, epsilon, bowAndArrow, trident)
	for (let trident = 1; trident<=9 ; trident++){
		for (let bowAndArrow = 1;bowAndArrow<=9;bowAndArrow++){
			for (let epsilon = 0;epsilon<=9;epsilon++){
				if (trident == bowAndArrow || trident == epsilon ||epsilon == bowAndArrow){
					continue;
				}

				const symbols = {trident, bowAndArrow, epsilon};
				checkSolution(2, getChest2PearlCount(symbols), symbols, possibleSolutionsCount, foundSolutionsCount, html);
			}
		}
	}

	//Chest 3 (stickMan, stickMan, Z, Z, bowAndArrow, bowAndArrow)
	for (let stickMan = 1; stickMan<=9 ; stickMan++){
		for (let Z = 0;Z<=9;Z++){
			for (let bowAndArrow = 1;bowAndArrow<=9;bowAndArrow++){

				if (stickMan == Z || stickMan == bowAndArrow || Z == bowAndArrow){
					continue;
				}

				const symbols = {stickMan, Z, bowAndArrow};
				checkSolution(3, getChest3PearlCount(symbols), symbols, possibleSolutionsCount, foundSolutionsCount, html);
			}
		}
	}

	//Chest 4 (bowAndArrow, stitches, stickMan, bowAndArrow, stitches, stickMan)
	for (let bowAndArrow = 1; bowAndArrow<=9 ; bowAndArrow++){
		for (let stitches = 0;stitches<=9;stitches++){
			for (let stickMan = 1;stickMan<=9;stickMan++){
			
				if (bowAndArrow == stitches || bowAndArrow == stickMan || stitches == stickMan){
					continue;
				}

				const symbols = {bowAndArrow, stitches, stickMan};
				checkSolution(4, getChest4PearlCount(symbols), symbols, possibleSolutionsCount, foundSolutionsCount, html);
			}
		}
	}

	//Chest 5 (house, trident, bowAndArrow, trident, bowAndArrow, house)
	for (let house = 1; house<=9 ; house++){
		for (let trident = 1;trident<=9;trident++){
			for (let bowAndArrow = 1;bowAndArrow<=9;bowAndArrow++){

				if (house == trident || house == bowAndArrow || trident == bowAndArrow){
					continue;
				}

				const symbols = {house, trident, bowAndArrow};
				checkSolution(5, getChest5PearlCount(symbols), symbols, possibleSolutionsCount, foundSolutionsCount, html);
			}
		}
	}

	const t1 = performance.now();

	for (let chestNumber = 1; chestNumber<=5; chestNumber++){
		html.append(`${getSolutionText(chestNumber, foundSolutionsCount[chestNumber], possibleSolutionsCount[chestNumber])}<br>`);
	}

	html.append(`The program took ${t1 - t0} milliseconds to run`);
}

</script>

<body>

<h1>Sea Monster Riddle</h1>
<h2>Introduction</h2>
<p>Source of this riddle is on this youtube video https://www.youtube.com/watch?v=YytHuow4VnU. I created this program to solve the riddle without looking at the solution.</p>
<br>
<h3>The riddle is as follows:</h3>
<br>
<p>According to legend, once every thousand years a host of sea monsters emerges from the depths to demand tribute from the floating city of Atlantartica. As the ruler of the city, you’d always dismissed the stories… until today, when they rose out of the roiling waters, surrounded your city and demanded a ransom of pearls. Can you figure out which chest of pearls is the ransom?</p>
<br>
<img src="treasure-chests.png"></img>
<br>
<p>1. You need to choose 1 of the 5 chests. The ancient numerals display an accurate count of each chest's pearls.</p>
<p>2. The pearls in your chest must divide into 7 equal piles. Each of those 7 piles must divide into 11 equal piles. Each of those 11 piles must divide into 13 equal piles.</p>
<p>3. Each of those divisions must leave no remainders.</p>
<p>4. The ancient numerical system was base 10</p>
<br>
<h3>Solution</h3>
<p>I have nominated the symbols with imaginative names</p>
Chest 1: trident, n, trident, n, trident, n
Chest 2: bowAndArrow, stitches, stickMan, bowAndArrow, stitches, stickMan
Chest 3: trident, bowAndArrow, epsilon, epsilon, bowAndArrow, trident
Chest 4: stickMan, stickMan, Z, Z, epsilon, epsilon
Chest 5: house, trident, bowAndArrow, trident, bowAndArrow, house
<button id="run-button">Solve riddle</button>
<br>
<p id="solution-log"></p>

</body>
