<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>

$(document).ready(function(){
  $("#run-button").click(() => {
  
	const solutionLogElement = $('#solution-log');
	
	solutionLogElement.text('');
	$('#analysis').text('');
	
	//$('#note-text').html('<b>Scroll all the way down to view the whole solution.</b>');
	
    runSolution( logText => solutionLogElement.append(`${logText} <br><br>`) );
	
  });
  $("#run-analysis-button").click(() => {
  
    runAnalysis((logText) => console.log(logText));
	
  });
  
	$("#run-brute-force-button").click(() => {
		const solutionLogElement = $('#solution-log');
		
		solutionLogElement.text('');
		runBruteForce((logText) => solutionLogElement.append(`${logText} <br><br>`));
	
  });
});

class Word {
	constructor(pronunciation, meaning) {
		this.pronunciation = pronunciation;
		this.meaning = meaning === true;
	}
	
	getPronunciation() {
		return this.pronunciation;
	}
	
	getMeaning() {
		return this.meaning;
	}
}

class Overlord {
	constructor(name, trueWord, falseWord) {
		this.name = name;
		this.trueWord = trueWord;
		this.falseWord = falseWord;
	}

	getName(){
		return this.name;
	}

	get trueAnswer (){
		return this.trueWord;
	}

	get falseAnswer (){
		return this.falseWord;
	}

	getAnswer(id, wordReference1, wordReference2) {
		throw new Exception('Not supported');

	}
}

class TruthfulOverlord extends Overlord {
	constructor(name, trueWord, falseWord) {
		super(name, trueWord, falseWord);
	}

	getAnswer(id, wordReference1, wordReference2) {
		
		if (id == obviousQuestion.id){
			return this.trueAnswer;
			
		} else if (id == referenceQuestion.id){
		
			if (wordReference1.getMeaning() == true) {
				return this.trueAnswer;
			} else if (wordReference1.getMeaning() == false){
				return this.falseAnswer;
			}
		} else if (id == answerComparisonQuestion.id) {
			if (wordReference1.getMeaning() == true && wordReference2.getMeaning() === true) {
				return this.trueAnswer;
			}
			return this.falseAnswer;
		}
		
		return "Hmm?"; //If this answer is reached, something is wrong with my code.
	}
}

class LyingOverlord extends Overlord {
	constructor(name, trueWord, falseWord) {
		super(name, trueWord, falseWord);
	}

	getAnswer(id, wordReference1, wordReference2) {
		
		if (id == obviousQuestion.id){
			return this.falseAnswer;
			
		} else if (id == referenceQuestion.id){

			if (wordReference1.getMeaning() == true) {
				return this.falseAnswer;
			} else if (wordReference1.getMeaning() == false){
				return this.trueAnswer;
			}
		} else if (id == answerComparisonQuestion.id) {
			if (wordReference1.getMeaning() == true && wordReference2.getMeaning() === true) {
				return this.falseAnswer;
			}
			return this.trueAnswer;
		}
		return "Hmm?";
	}
}

class RandomOverlord extends Overlord {
	constructor(name, trueWord, falseWord) {
		super(name, trueWord, falseWord);
	}

	getAnswer() {
		const randomizer = getRandomInt(2);
		return randomizer == 0 ? this.trueAnswer : this.falseAnswer;
	}
}

class AgreeableOverlord extends Overlord {
	constructor(name, trueWord) {
		super(name, trueWord);
	}

	getAnswer() {
		return this.trueAnswer;
	}
}

class DisagreeableOverlord extends Overlord {
	constructor(name, falseWord) {
		super(name, falseWord);
	}

	getAnswer() {
		return this.falseAnswer;
	}
}

function getRandomInt(max) {
  return Math.floor(Math.random() * Math.floor(max));
}

const obviousQuestion = {
	id: 0,
	question: 'Is the sky blue?',
	description: 'An obvious question that you know the answer to.'
}

const referenceQuestion = {
	id: 1,
	question: 'Was the answer to the first question a yes?',
	description: "Ask an overlord information on another's answer."
}

const answerComparisonQuestion = {
	id: 2,
	question: 'Did the last two answers agree with each other?',
	description: 'Asks the overlord to compare two answers'
}

const log = [];

let gameId = 0;

const runSolution = (printFunction) => {

	printFunction('Starting program..');

	const t0 = performance.now();

	const wordPronunciations = shuffle(['Oko', 'Unu']);
	
	const wordForTrue = new Word(wordPronunciations[0], true);
	const wordForfalse = new Word(wordPronunciations[1], false);
	
	console.log(wordForTrue, wordForfalse);
	
	const overlords = shuffle([new TruthfulOverlord('Tee', wordForTrue, wordForfalse), 
		new LyingOverlord('Eff', wordForTrue, wordForfalse),
		new RandomOverlord('Arr', wordForTrue, wordForfalse)]);
	
	const [overlord1, overlord2, overlord3] = overlords;
	console.log(overlords);
	
	const questionsAndAnswers = [];

	const gameLog = {
		id: gameId,
		questionsAndAnswers,
		overlords,
		wordForTrue,
		wordForfalse
	}
		
	{
		printFunction(obviousQuestion.question);
		
		const anwerOfLord1Question1 = overlord1.getAnswer(obviousQuestion.id);
		printFunction(`Overlord 1: ${anwerOfLord1Question1.getPronunciation()}`);


		
		questionsAndAnswers.push({
			question: obviousQuestion,
			orderNumber: 0,
			addressedTo:0,
			answer: anwerOfLord1Question1.getPronunciation()
		});

		printFunction(referenceQuestion.question);
		const anwerOfLord2Question2 = overlord2.getAnswer(referenceQuestion.id, anwerOfLord1Question1);
		printFunction(`Overlord 2: ${anwerOfLord2Question2.getPronunciation()}`);

		questionsAndAnswers.push({
			question: referenceQuestion,
			orderNumber: 1,
			addressedTo: 1,
			answer: anwerOfLord2Question2.getPronunciation()
		});
		
		printFunction(answerComparisonQuestion.question);
		
		const answerOfLord1Question3 = overlord1.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord2Question2)
		printFunction(`Overlord 1: ${answerOfLord1Question3.getPronunciation()}`);
		
		const answerOfLord2Question3 = overlord2.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord2Question2)
		printFunction(`Overlord 2: ${answerOfLord2Question3.getPronunciation()}`);
		
		const answerOfLord3Question3 = overlord3.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord2Question2)
		printFunction(`Overlord 3: ${answerOfLord3Question3.getPronunciation()}`);
		
		questionsAndAnswers.push({
			question: answerComparisonQuestion,
			orderNumber: 2,
			addressedTo: 0,
			answer: answerOfLord1Question3.getPronunciation()
		},
		{
			question: answerComparisonQuestion,
			orderNumber: 2,
			addressedTo:1,
			answer: answerOfLord2Question3.getPronunciation()
		},
		{
			question: answerComparisonQuestion,
			orderNumber: 2,
			addressedTo:2,
			answer: answerOfLord3Question3.getPronunciation()
		});
	}
	log.push(gameLog);
	
	console.log(log);
	gameId++;
	
	const t1 = performance.now();

	printFunction(`The program took ${t1 - t0} milliseconds to run.<br>`);

	printFunction('Program finished.');
}

/* Disabled the second round.
	printFunction('Round 2..');
	{
		printFunction(obviousQuestion.question);
		
		const anwerOfLord1Question1 = overlord1.getAnswer(obviousQuestion.id);
		printFunction(`Overlord 1: ${anwerOfLord1Question1.getPronunciation()}`);
		
		printFunction(referenceQuestion.question);
		const anwerOfLord1Question2 = overlord1.getAnswer(referenceQuestion.id, anwerOfLord1Question1);
		printFunction(`Overlord 1: ${anwerOfLord1Question2.getPronunciation()}`);
		
		printFunction(answerComparisonQuestion.question);
		
		printFunction(`Overlord 1: ${overlord1.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord1Question2).getPronunciation()}`);
		printFunction(`Overlord 2: ${overlord2.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord1Question2).getPronunciation()}`);
		printFunction(`Overlord 3: ${overlord3.getAnswer(answerComparisonQuestion.id, anwerOfLord1Question1, anwerOfLord1Question2).getPronunciation()}`);
	}*/

/*
obviousQuestion
referenceQuestion
answerComparisonQuestion
*/
class DirectedQuestion {
	constructor(question, receiverOrderNumber) {
		this.question = question;
		this.receiverOrderNumber = receiverOrderNumber;
	}
	
	setAnswer(answer) {
		this.answer=answer;
	}
	
	getAnswer() {
		return this.answer;
	}
}

const runAnalysis = (outputFunction) => {
	const wordOko = {id:0, pronunciation:'Oko'};
	const wordUnu = {id:1, pronunciation:'Unu'};
	
	//const directedQuestions = [new DirectedQuestion(obviousQuestion, 0), new DirectedQuestion(obviousQuestion, 1), new DirectedQuestion(obviousQuestion, 2)]
	{
		const wordForTrue = new Word(wordOko, true);
		const wordForfalse = new Word(wordUnu, false);
		const overlordConfigurations = getOverlordConfigurations(wordForTrue, wordForfalse);
		console.log(wordForTrue, wordForfalse, overlordConfigurations);
	}
	
	{
		const wordForTrue = new Word(wordUnu, true);
		const wordForfalse = new Word(wordOko, false);
		const overlordConfigurations = getOverlordConfigurations(wordForTrue, wordForfalse);
		console.log(wordForTrue, wordForfalse, overlordConfigurations);
	}
}

const getOverlordConfigurations = (wordForTrue, wordForfalse) => {
	const tee = new TruthfulOverlord({id:0, name:'Tee'}, wordForTrue, wordForfalse);
	const eff = new LyingOverlord({id:1, name:'Eff'}, wordForTrue, wordForfalse);
	const agg = new AgreeableOverlord({id:2, name:'Agg'}, wordForTrue);
	const dis = new DisagreeableOverlord({id:2, name:'Dis'}, wordForfalse);
	
	const overlords1 = [tee, eff, agg];
	const overlords2 = [tee, agg, eff];
	const overlords3 = [eff, tee, agg];
	const overlords4 = [eff, agg, tee];
	const overlords5 = [agg, tee, eff];
	const overlords6 = [agg, eff, tee];
	
	const overlords7 = [tee, eff, dis];
	const overlords8 = [tee, dis, eff];
	const overlords9 = [eff, tee, dis];
	const overlords10 = [eff, dis, tee];
	const overlords11 = [dis, tee, eff];
	const overlords12 = [dis, eff, tee];
	
	return [overlords1, overlords2, overlords3, overlords4, overlords5, overlords6, overlords7, overlords8, overlords9, overlords10, overlords11, overlords12];
}

function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}



</script>

<body>

<h1>Three Alien Overlords</h1>
<h2>Introduction</h2>
<a>Source of this riddle is on</a> <a href="https://www.youtube.com/watch?v=LKvjIsyYng8">this youtube video</a><a>. I am writing this program to help me solve the riddle without looking at the solution.</a>
<p>I don't expect this to be easy and I don't expect to reach a solution with this program alone. The goal is to learn as much as possible of the puzzle with this program.</p>
<h2>Deductions</h2>
<p>Here are deductions that I have made this far</p>
<li>The odds of guessing the overlords correctly is 1/3 * 1/2 = 1/6 or about 16.7%. There are six different ways to present the idols to the overlords.</li>
<li>The correct solution will have a 100% success rate, regardless of the order that the overlords appear and what the meaning for the words oko and unu are.</li>

<li>If I asked the same overlord three questions, it would help me figure who that overlord is. Then I would have a 50% chance of guessing the other two. I doubt that asking the same overlord three questions is the right way to go.</li>
<li>The possible combinations of directing questions to overlords is as follows. The number refers to which overlord you're addressing the question to (1,1,2 means 'Ask the first overlord a question, then the first one again, then the second one'):</li>
<ol>
	1, 1, 2<br>
	1, 2, 2<br>
	1, 2, 1<br>
	1, 2, 3<br>
</ol>
<li>'Ask the first one in line a question, then ask the second, then ask the second one again' is fundamentally the same as 'Ask the first one in line a question, then ask the third, then ask the third one again'. This is because I don't know which overlord is which.</li>
<li>I cannot deduce anything after asking the first question, since I don't know if the answer is a yes or a no. The only correct choice is to ask the second Overlord in line a question. It also makes no sense to ask the same question from the second overlord since the first answer gave me no information. The second question must be different from the first.</li>
<br><br>
<button id="run-button">Run</button>
<button id="run-analysis-button">Run analysis</button>
<br>
<p id="note-text"></p>
<br>
<p id="solution-log"></p>
<br>
<br>
<p id="analysis"></p>

</body>
